---
import { getCollection, render } from "astro:content";
import BaseHead from "../../components/BaseHead.astro";
import { SITE_TITLE } from "../../consts";

export async function getStaticPaths() {
    const posts = await getCollection("blog");
    return posts.map((post) => ({
        params: { id: post.id },
        props: { post },
    }));
}

const { post } = Astro.props;
const { Content } = await render(post);
---

<!doctype html>
<html lang="en">
    <head>
        <BaseHead
            title={post.data.title + " - " + SITE_TITLE}
            description={"Blog entry published " +
                post.data.publishDate.toISOString().split("T")[0]}
        />
    </head>
    <body>
        <main class="pt-16">
            <a href="/" class="inline-flex items-center text-orange-400 hover:text-orange-300 transition-colors mb-6">
                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                Back to home
            </a>
            
            <article class="blog-content">
                <header class="mb-8 pb-6 border-b border-gray-700">
                    <h1 class="text-4xl font-bold text-white mb-4">{post.data.title}</h1>
                    <div class="flex items-center text-gray-400 text-sm">
                        <time datetime={post.data.publishDate.toISOString()}>
                            Published on {post.data.publishDate.toLocaleDateString('en-US', { 
                                year: 'numeric', 
                                month: 'long', 
                                day: 'numeric' 
                            })}
                        </time>
                        {post.data.updatedDate && (
                            <span class="ml-4">
                                Updated on {post.data.updatedDate.toLocaleDateString('en-US', { 
                                    year: 'numeric', 
                                    month: 'long', 
                                    day: 'numeric' 
                                })}
                            </span>
                        )}
                    </div>
                </header>
                
                <div class="prose-content">
                    <Content />
                </div>
            </article>
        </main>
    </body>
</html>
